<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<title>Приложение C. Перечень изменений</title>
</head>
<body bgcolor=#d3d3d3>
<font face=Arial>
<hr>
<p><a href="index.html#content">Содержание</a></p>
<h2>Приложение C. Перечень изменений</h2>
<hr>
<p>С момента публикации первого издания этой книги определение языка Си 
претерпело изменения. Почти все нововведения - это расширения исходной версии 
языка, выполненные так, чтобы сохранилась совместимость с существующими 
программами; некоторые изменения касаются устранения двусмысленностей 
первоначального описания, а некоторые представляют собой модификации, 
привнесенные существующей практикой. Многие из новых возможностей, 
впоследствии принятые другими разработчиками Си-компиляторов, были 
первоначально объявлены в документах, прилагаемых к компиляторам. Комитет 
ANSI, подготавливая стандарт языка, включил большинство этих изменений, а 
также ввел другие значительные модификации. Некоторые коммерческие компиляторы 
реализовали их еще до выпуска официального Си-стандарта.
</p>
<p>
В этом приложении сведены воедино различия между языком, определенным в первой 
его редакции, и той его версии, которая принята в качестве стандарта. Здесь 
рассматривается только сам язык; вопросы, относящиеся к его окружению и 
библиотеке, не затрагиваются. Хотя последние и являются важной частью 
стандарта, но, поскольку в первом издании не делалось попытки описать среду и 
библиотеку, с соответствующими стандартными элементами сравнивать практически 
нечего.</p>
<dir>
<li>В стандарте более тщательно, по сравнению с первым изданием, определено и 
расширено препроцессирование: в его основу явно положены лексемы; введены 
новые операторы для "склеивания" лексем (<b>##</b>) и создания символьных 
строк (<b>#</b>), а также новые управляющие строки, такие как <b>#elif</b> и 
<b>#pragma</b>; разрешено повторное определение макроса с той же 
последовательностью лексем; отменена подстановка параметров внутри строк. 
Разрешено "склеивание" строк с помощью знака <b>\</b> в любом месте, не только 
в строках и макроопределениях (см. <a href="a.html#a12">A.12</a>).

<li>Минимальное число значимых символов всех внутренних идентификаторов 
доведено до 31; для идентификаторов с внешней связью оно остается равным 6; 
буквы нижнего и верхнего регистров не различаются. (Многие реализации 
допускают большее число значимых символов.)

<li>Для знаков <b>#</b>, <b>\</b>, <b>^</b>, <b>[</b>, <b>]</b>, <b>{</b>, <b>}</b>, <b>|</b>, <b>~</b>, 
которых может не быть в некоторых 
наборах символов, введены трехзнаковые последовательности, начинающиеся с 
<b>??</b> (см. <a href="a.html#a12_1">A12.1</a>). Следует заметить, что введение трехзнаковых 
последовательностей может повредить значения строк, в которых содержатся 
<b>??</b>.

<li>Введены новые ключевые слова (<b>void</b>, <b>const</b>, <b>volatile</b>, 
<b>signed</b>, <b>enum</b>), а мертворожденное слово <b>entry</b> из обращения 
изъято.

<li>Для символьных констант и строковых литералов определены новые эскейп-
последовательности. Объявлено, что появление за <b>\</b> символов не из 
принятых эскейп-последовательностей приводит к непредсказуемому результату 
(см. <a href="a.html#a2_5_2">A2.5.2</a>.).

<li>Узаконено полюбившееся всем тривиальное изменение: 8 и 9 не являются 
восьмеричными цифрами.

<li>Введен расширенный набор суффиксов для явного указания типов констант: 
<b>U</b> и <b>L</b> - для целых и <b>F</b> и <b>L</b> - для типов с плавающей 
точкой. Уточнены также правила определения типа для констант без суффиксов 
(<a href="a.html#a2_5">A2.5</a>).

<li>Объявлено, что соседние строки конкатенируются.

<li>Предоставлены средства, позволяющие записывать строковые литералы и 
символьные константы из расширенного набора символов (<a href="a.html#a2_6">A2.6</a>).

<li>Объекты типа <b>char</b> (как и объекты другого типа) можно 
специфицировать явно со знаком или без знака. Исключается использование 
словосочетания <b>long float</b> в смысле <b>double</b>, но вводится тип 
<b>long double</b> для чисел с плавающей точкой повышенной точности.

<li>С некоторых пор доступен тип <b>unsigned char</b>. Стандарт вводит 
ключевое слово <b>signed</b> для явного указания, что объект типа <b>char</b> 
или другого целочисленного типа имеет знак.

<li>Уже несколько лет в большинстве реализаций доступен тип <b>void</b>. 
Стандарт вводит <b>void *</b> в качестве типа обобщенного указателя; раньше 
для этой цели использовали <b>char *</b>. Одновременно вступают в силу 
правила, по которым запрещается без преобразования типа "смешивать" указатели 
и целые или указатели разных типов.

<li>Стандарт устанавливает минимальные пределы диапазонов арифметических 
типов, предусматривает заголовочные файлы <b>&lt;limits.h&gt;</b> и 
<b>&lt;float.h&gt;</b>, в которых помещаются эти характеристики для каждой 
конкретной реализации.

<li><b>Перечисление</b> - новый тип, которого не было в первой редакции.

<li>Стандарт заимствует из C++ способ записи квалификатора типа, в частности 
квалификатора <b>const</b> (<a href="a.html#a8_2">A8.2</a>).

<li>Вводится запрет на модификацию строк: это значит, что их разрешается 
размещать в памяти, доступной только на чтение (ПЗУ).

<li>Изменены "обычные арифметические преобразования"; по существу, выполнен 
переход от принципа "для целых всегда превалирует <b>unsigned</b>; для 
плавающей точки всегда используется <b>double</b>" к принципу "повышение до 
минимального достаточно вместительного типа" (см. <a href="a.html#a6_5">A6.5</a>).

<li>Отменены старые операторы присваивания вроде <b>=+</b>. Каждый оператор 
присваивания теперь представляется одной отдельной лексемой. В первом издании 
оператор присваивания мог изображаться парой символов, возможно, разделенных 
символами-разделителями.

<li>Компиляторам более не разрешается трактовать математическую 
ассоциативность операторов как вычислительную ассоциативность.

<li>Введен унарный оператор <b>+</b> для симметрии с унарным <b>-</b>.

<li>Разрешено использовать указатель на функцию в качестве ее именующего 
выражения без явного оператора <b>*</b> (см. <a href="a.html#a7_3_2">A7.3.2</a>).

<li>Структурами разрешено оперировать при присваиваниях, можно передавать 
структуры в качестве аргументов функциям и получать их в качестве результата 
от функций.

<li>Разрешено применять оператор получения адреса <b>&</b> к массиву; 
результатом является указатель на массив.

<li>В первой редакции результат операции <b>sizeof</b> имел тип <b>int</b>; во 
многих реализациях он заменен на <b>unsigned</b>. Стандарт официально 
объявляет его зависимым от реализации, но требует, чтобы он был определен в 
заголовочном файле <b>&lt;stddef.h&gt;</b> под именем <b>size_t</b>. 
Аналогичное изменение было сделано в отношении типа разности указателей) 
который теперь выступает под именем <b>ptrdiff_t</b> (см. <a href="a.html#a7_4_8">A7.4.8</a> и <a href="a.html#a7_7">A7.7</a>).

<li>Запрещено применять оператор получения адреса <b>&</b> к объекту типа 
<b>register</b> даже тогда, когда данный компилятор не располагает его на 
регистре.

<li>Типом результата операции сдвига является тип ее левого операнда; тип 
правого операнда на повышение типа результата влияния не оказывает (см. <a href="a.html#a7_8">A7.8</a>).

<li>Стандарт разрешает адресоваться с помощью указателей на место, лежащее 
сразу за последним элементом массива, и позволяет оперировать с такими 
указателями, как с обычными, см. <a href="a.html#a7_7">A7.7</a>.

<li>Стандарт вводит (заимствованный из C++) способ записи прототипа функции с 
включением в него типов параметров и явного указания о возможности их 
изменения и формализует метод работы с переменным списком аргументов. (см. 
<a href="a.html#a7_3_2">A7.3.2</a>, <a href="a.html#a8_6_3">A8.6.3</a>, <a href="b.html#b7">B7</a>.) С некоторыми ограничениями доступен и старый способ 
записи.

<li>Стандартом запрещены пустые объявления, т. е. такие, в которых нет 
объявителей и не объявляется ни одной структуры, объединения или перечисления. 
Однако объявление с одним тегом структуры (или объединения) переобъявит ее 
даже в том случае, если она была объявлена во внешней области действия.

<li>Запрещены объявления внешних данных, не имеющие спецификаторов и 
квалификаторов (т. е. объявления с одним "голым" объявителем).

<li>В некоторых реализациях, когда <b>extern</b>-объявление расположено во 
внутреннем блоке, его область видимости распространяется на остальную часть 
файла. Стандарт вносит ясность в эту ситуацию и объявляет, что область 
видимости такого объявления ограничена блоком.

<li>Область видимости параметров "вставляется" в составную инструкцию, 
представляющую собой тело функции, так что объявления на верхнем уровне 
функции не могут их "затенить".

<li>Несколько изменены именные пространства идентификаторов. Всем тегам 
структур, объединений и перечислений стандарт выделяет одно именное 
пространство; для меток инструкций вводится отдельное именное пространство 
(см. <a href="a.html#a11_1">A11.1</a>). Кроме того, имена элементов связаны со структурой или 
объединением, частью которого они являются. (С некоторых пор это общепринятая 
практика.)

<li>Допускается инициализация объединения; инициализатор относится к первому 
элементу объединения.

<li>Разрешается инициализация автоматических структур, объединений и массивов, 
хотя и с некоторыми ограничениями.

<li>Разрешается инициализация массива символов с помощью строкового литерала 
по точному количеству указанных символов (без '\0').

<li>Управляющее выражение и <b>case</b>-метки в <b>switch</b> могут иметь 
любой целочисленный тип.
</dir>
</body>
</html>
