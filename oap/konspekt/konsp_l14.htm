<html>
<head>
<title>ОП | Для конспекта | Лекция № 14
</title>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="ru">
<LINK REL=STYLESHEET TYPE="text/css" HREF="../css/style.css" title="style">
</head>
<body bgcolor="#ffffff" text="000066">
<p><center><table width="100%">
<tr bgcolor="#f3f3f3" class="author"><td align=center valign=top>Для конспекта
</td></tr>
<tr><td>
<p>&nbsp;</p>
<h2>Функции работы с файлами</h2>
<ol>
<p><li>Файлы - именованные объекты, доступ к которым поддерживает операционная система.
<p><li>Последовательный файл - именованная цепочка (строка) байтов, имеющая начало и конец.
<p><li>Указатель на файлы - указатель на файловую структуру в памяти, при записи информации в файл или при чтении из файла программа получает необходимую информацию из структуры.
<p><li>Определение указателя на файл: &nbsp; FILE *fp;
<p><li>Открытие файла - процедура, информирующая систему о тех действиях, которые предполагается выполнять с файлом.
<p><li>Функция
<ul>FILE *fopen(char *filename, char *type);</ul>
<p>открывает поток, устанавливает связь между программой и файлом.
<p><li>В определении
<ul>FILE *fopen(char *filename, char *type);</ul>
<p>значение символьной строки type означает:
<p><table border=0 align=center cellpadding=5>
<tr valign="top"><td>r</td><td>открытие файла только для чтения,</td></tr>
<tr valign="top"><td>w</td><td>создание файла для записи. Если файл уже существует на диске, вся 
информация, записанная в нем на данный момент, будет заменена новой 
информацией,</td></tr>
<tr valign="top"><td>а</td><td>присоединение. Открытие для записи в конец файла или создание для записи, 
если файл не существует,</td></tr>
<tr valign="top"><td>r+</td><td>открытие существующего файла для обновления (чтения и записи),</td></tr>
<tr valign="top"><td>w+</td><td>создание нового файла для изменения,</td></tr>
<tr valign="top"><td>a+</td><td>открытие для присоединения; открытие (или создание, если файл не существует) для обновления в конец файла.</td></tr>
</table>
<p><li>Закрытие файла - прерывание связи между файлом и программой после окончания записи в файл или чтения из файла.
<p><li>Функция<ul>int fclose (FILE *str);</ul><p>закрывает поток
<p><li>Функции, используемые для вывода данных в файл, зависят от типа данных и способа их представления. 
<ul type="disc">
<li>функции вывода строк (fputs), 
<li>функции вывода символов (putc, fputc), 
<li>функции форматированного вывода (семейство ... printf - fprintf). 
</ul>
<p><li>Функции, используемые для чтения данных из файла, зависят от типа данных и способа их представления. 
<ul type="disc">
<li>функции чтения строк (fgets), 
<li>функции чтения символов (getc, fgetc, fgetchar), 
<li>функции форматированного ввода (семейство ... scanf - fscanf). 
</ul>
<p><li>При работе с файлами необходимо выполнить следующую последовательность действий:
<ol>
<li>Определить указатель на файл<ul>FILE *f;</ul>
<p><li>Открыть файл и указать цель открытия (файл pr08_fio.dat открыт для записи в каталоге fil_dat)
<ul>
if ((f = fopen("..\\fil_dat\\pr08_fio.dat", "w")) == NULL)
<br>{
<br>&nbsp;&nbsp;fprintf(stderr, "Ошибка! Не удается открыть файл...\n");
<br>&nbsp;&nbsp;return 1;
<br>}
</ul>
<p><li>Поработать с файлом (например, записать в открытый файл значение целого числа i, вещественного числа z и строки str)
<ul>
<br>&nbsp;&nbsp;fprintf (f, "%d\t%f\t%s\n", i, z, str);
</ul>
<p><li>Закрыть файл<ul>fclose (f);</ul>
</ol>
<p><li>Функция записать в файл начинается с заголовка (тип возвращаемого функцией значения, имя функции, список передаваемых в нее параметров), затем в теле функции набор выполняемых команд (определить указатель на файл, открыть файл, поработать с файлом, закрыть файл):
<pre>
	int fil_zap(int i, float z, char *str)
	{
		FILE *f;
		if ((f = fopen("..\\fil_dat\\pr08_fio.dat", "w")) == NULL)
		{
			fprintf(stderr, "Ошибка! Не удается открыть файл...\n");
			return 1;
		}
		fprintf (f, "%d\t%f\t%s\n", i, z, str);
		fclose (f);
		return 0;
	}
</pre>
</ol>
<p>&nbsp;</p>
</td></tr>
<tr bgcolor="#f3f3f3"><td align=center valign=top class="author">&copy;&nbsp;Ставропольский колледж связи, 2011
</td></tr><tr><td>
</table></center></p>
</body>
</html> 